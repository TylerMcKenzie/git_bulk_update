<?php
/**
 * Generated by Haxe 3.4.7
 */

namespace tink\core;

use \tink\core\_Outcome\OutcomeMapper_Impl_;
use \php\Boot;
use \php\_Boot\HxException;
use \haxe\ds\Option as DsOption;
use \tink\core\_Lazy\LazyObject;
use \php\_Boot\HxAnon;

class OutcomeTools {
	/**
	 *  Try to run `f` and wraps the result in `Success`,
	 *  thrown exceptions are transformed by `report` then wrapped into a `Failure`
	 * 
	 * @param \Closure $f
	 * @param \Closure $report
	 * 
	 * @return Outcome
	 */
	static public function attempt ($f, $report) {
		#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:138: lines 138-140
		try {
			#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:138: characters 10-22
			return Outcome::Success($f());
		} catch (\Throwable $__hx__caught_e) {
			$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
			$e = $__hx__real_e;
			#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:140: characters 8-26
			return Outcome::Failure($report($e));
		}
	}


	/**
	 *   Returns `true` if the outcome is `Some` and the value is equal to `v`, otherwise `false`
	 * 
	 * @param Outcome $outcome
	 * @param mixed $to
	 * 
	 * @return bool
	 */
	static public function equals ($outcome, $to) {
		#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:84: lines 84-87
		switch (Boot::dynamicField($outcome, 'index')) {
			case 0:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:85: characters 21-25
				$data = $outcome->params[0];
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:85: characters 28-38
				return Boot::equal($data, $to);
				break;
			case 1:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:86: characters 25-30
				return false;
				break;
		}
	}


	/**
	 *  Transforms the outcome with a transform function
	 *  Different from `map`, the transform function of `flatMap` returns an `Outcome`
	 * 
	 * @param Outcome $o
	 * @param object $mapper
	 * 
	 * @return Outcome
	 */
	static public function flatMap ($o, $mapper) {
		#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:117: characters 4-26
		return OutcomeMapper_Impl_::apply($mapper, $o);
	}


	/**
	 * @param Outcome $o
	 * 
	 * @return Outcome
	 */
	static public function flatten ($o) {
		#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:143: lines 143-146
		switch (Boot::dynamicField($o, 'index')) {
			case 0:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:143: characters 18-19
				switch (Boot::dynamicField($o->params[0], 'index')) {
					case 0:
						#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:144: characters 27-28
						$d = $o->params[0]->params[0];
						#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:144: characters 32-42
						return Outcome::Success($d);
						break;
					case 1:
						#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:145: characters 27-28
						$f = $o->params[0]->params[0];
						#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:145: characters 45-55
						return Outcome::Failure($f);
						break;
				}
				break;
			case 1:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:145: characters 41-42
				$f1 = $o->params[0];
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:145: characters 45-55
				return Outcome::Failure($f1);
				break;
		}
	}


	/**
	 *  Returns `true` if the outcome is `Success`
	 * 
	 * @param Outcome $outcome
	 * 
	 * @return bool
	 */
	static public function isSuccess ($outcome) {
		#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:106: lines 106-109
		if (Boot::dynamicField($outcome, 'index') === 0) {
			#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:107: characters 25-29
			return true;
		} else {
			#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:108: characters 17-22
			return false;
		}
	}


	/**
	 *  Transforms the outcome with a transform function
	 *  Different from `flatMap`, the transform function of `map` returns a plain value
	 * 
	 * @param Outcome $outcome
	 * @param \Closure $transform
	 * 
	 * @return Outcome
	 */
	static public function map ($outcome, $transform) {
		#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:94: lines 94-99
		switch (Boot::dynamicField($outcome, 'index')) {
			case 0:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:95: characters 21-22
				$a = $outcome->params[0];
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:96: characters 10-31
				return Outcome::Success($transform($a));
				break;
			case 1:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:97: characters 21-22
				$f = $outcome->params[0];
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:98: characters 10-20
				return Outcome::Failure($f);
				break;
		}
	}


	/**
	 *  Extracts the value if the option is `Success`, otherwise `null`
	 * 
	 * @param Outcome $outcome
	 * 
	 * @return mixed
	 */
	static public function orNull ($outcome) {
		#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:55: lines 55-58
		switch (Boot::dynamicField($outcome, 'index')) {
			case 0:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:56: characters 21-25
				$data = $outcome->params[0];
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:56: characters 28-32
				return $data;
				break;
			case 1:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:57: characters 25-29
				return null;
				break;
		}
	}


	/**
	 *  Extracts the value if the option is `Success`, uses the fallback `Outcome` otherwise
	 * 
	 * @param Outcome $outcome
	 * @param LazyObject $fallback
	 * 
	 * @return Outcome
	 */
	static public function orTry ($outcome, $fallback) {
		#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:75: lines 75-78
		switch (Boot::dynamicField($outcome, 'index')) {
			case 0:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:76: characters 25-32
				return $outcome;
				break;
			case 1:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:77: characters 25-39
				return $fallback->get();
				break;
		}
	}


	/**
	 *  Extracts the value if the option is `Success`, uses the fallback value otherwise
	 * 
	 * @param Outcome $outcome
	 * @param LazyObject $fallback
	 * 
	 * @return mixed
	 */
	static public function orUse ($outcome, $fallback) {
		#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:65: lines 65-68
		switch (Boot::dynamicField($outcome, 'index')) {
			case 0:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:66: characters 21-25
				$data = $outcome->params[0];
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:66: characters 28-32
				return $data;
				break;
			case 1:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:67: characters 25-39
				return $fallback->get();
				break;
		}
	}


	/**
	 *  Extracts the value if the outcome is `Success`, throws the `Failure` contents otherwise
	 * 
	 * @param Outcome $outcome
	 * 
	 * @return mixed
	 */
	static public function sure ($outcome) {
		#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:18: lines 18-26
		switch (Boot::dynamicField($outcome, 'index')) {
			case 0:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:19: characters 21-25
				$data = $outcome->params[0];
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:20: characters 10-14
				return $data;
				break;
			case 1:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:21: characters 21-28
				$failure = $outcome->params[0];
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:22: characters 17-39
				$_g = TypedError::asError($failure);
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:23: lines 23-24
				if ($_g === null) {
					#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:23: characters 23-28
					throw new HxException($failure);
				} else {
					#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:24: characters 17-18
					$e = $_g;
					#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:24: characters 20-33
					return $e->throwSelf();
				}
				break;
		}
	}


	/**
	 *  Like `map` but with a plain value instead of a transform function, thus discarding the orginal result
	 * 
	 * @param Outcome $outcome
	 * @param mixed $v
	 * 
	 * @return Outcome
	 */
	static public function swap ($outcome, $v) {
		#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:125: lines 125-130
		switch (Boot::dynamicField($outcome, 'index')) {
			case 0:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:126: characters 21-22
				$a = $outcome->params[0];
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:127: characters 10-20
				return Outcome::Success($v);
				break;
			case 1:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:128: characters 21-22
				$f = $outcome->params[0];
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:129: characters 10-20
				return Outcome::Failure($f);
				break;
		}
	}


	/**
	 *  Creates an `Option` from this `Outcome`, discarding the `Failure` information
	 * 
	 * @param Outcome $outcome
	 * 
	 * @return DsOption
	 */
	static public function toOption ($outcome) {
		#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:33: lines 33-36
		switch (Boot::dynamicField($outcome, 'index')) {
			case 0:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:34: characters 21-25
				$data = $outcome->params[0];
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:34: characters 28-45
				return DsOption::Some($data);
				break;
			case 1:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:35: characters 25-36
				return DsOption::None();
				break;
		}
	}


	/**
	 *  Creates an `Outcome` from an `Option`, with made-up `Failure` information
	 * 
	 * @param DsOption $option
	 * @param object $pos
	 * 
	 * @return Outcome
	 */
	static public function toOutcome ($option, $pos = null) {
		#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:43: lines 43-48
		switch (Boot::dynamicField($option, 'index')) {
			case 0:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:44: characters 18-23
				$value = $option->params[0];
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:45: characters 10-24
				return Outcome::Success($value);
				break;
			case 1:
				#/home/vagrant/haxelib/tink_core/1,23,0/src/tink/core/Outcome.hx:47: characters 10-123
				return Outcome::Failure(new TypedError(404, "Some value expected but none found in " . ($pos->fileName??'null') . "@line " . ($pos->lineNumber??'null'), new HxAnon([
					"fileName" => "Outcome.hx",
					"lineNumber" => 47,
					"className" => "tink.core.OutcomeTools",
					"methodName" => "toOutcome",
				])));
				break;
		}
	}
}


Boot::registerClass(OutcomeTools::class, 'tink.core.OutcomeTools');
