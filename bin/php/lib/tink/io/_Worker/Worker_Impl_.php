<?php
/**
 * Generated by Haxe 3.4.7
 */

namespace tink\io\_Worker;

use \php\Boot;
use \tink\io\WorkerObject;
use \tink\core\_Future\FutureObject;
use \tink\core\_Lazy\LazyObject;

final class Worker_Impl_ {
	/**
	 * @var WorkerObject
	 */
	static public $EAGER;
	/**
	 * @var \Array_hx
	 */
	static public $pool;


	/**
	 * @param WorkerObject $this
	 * 
	 * @return WorkerObject
	 */
	static public function ensure ($this1) {
		#/home/vagrant/haxelib/tink_io/0,7,0/src/tink/io/Worker.hx:17: characters 11-44
		if ($this1 === null) {
			#/home/vagrant/haxelib/tink_io/0,7,0/src/tink/io/Worker.hx:17: characters 29-34
			return Worker_Impl_::get();
		} else {
			#/home/vagrant/haxelib/tink_io/0,7,0/src/tink/io/Worker.hx:17: characters 40-44
			return $this1;
		}
	}


	/**
	 * @return WorkerObject
	 */
	static public function get () {
		#/home/vagrant/haxelib/tink_io/0,7,0/src/tink/io/Worker.hx:20: characters 16-39
		$x = Worker_Impl_::$pool->length;
		#/home/vagrant/haxelib/tink_io/0,7,0/src/tink/io/Worker.hx:20: characters 4-40
		return (Worker_Impl_::$pool->arr[($x <= 1 ? 0 : mt_rand(0, $x - 1))] ?? null);
	}


	/**
	 * @param WorkerObject $this
	 * @param LazyObject $task
	 * 
	 * @return FutureObject
	 */
	static public function work ($this1, $task) {
		#/home/vagrant/haxelib/tink_io/0,7,0/src/tink/io/Worker.hx:23: characters 4-26
		return $this1->work($task);
	}


	/**
	 * @internal
	 * @access private
	 */
	static public function __hx__init ()
	{
		static $called = false;
		if ($called) return;
		$called = true;


self::$EAGER = new EagerWorker();
self::$pool = \Array_hx::wrap([Worker_Impl_::$EAGER]);
	}
}


Boot::registerClass(Worker_Impl_::class, 'tink.io._Worker.Worker_Impl_');
Worker_Impl_::__hx__init();
